{"version":3,"file":"index.js","names":["_index","require","_stripAnsi","_interopRequireDefault","_lodash","isStringPayload","action","payload","sanitizeAction","copiedAction","cloneDeep","text","stripAnsi","statusText","initializeJSONLogger","onLogAction","sanitizedAction","process","stdout","write","JSON","stringify"],"sources":["../../../../src/reporter/loggers/json/index.ts"],"sourcesContent":["import { onLogAction } from \"../../redux/index\";\nimport { ActionsUnion, ISetStatus } from \"../../redux/types\";\nimport stripAnsi from \"strip-ansi\";\nimport cloneDeep from \"lodash.clonedeep\";\n\nconst isStringPayload = (action: ActionsUnion): action is ISetStatus =>\n  typeof action.payload === `string`;\n\nconst sanitizeAction = (action: ActionsUnion): ActionsUnion => {\n  const copiedAction = cloneDeep(action);\n\n  if (isStringPayload(copiedAction)) {\n    return copiedAction;\n  }\n\n  if (`text` in copiedAction.payload && copiedAction.payload.text) {\n    copiedAction.payload.text = stripAnsi(copiedAction.payload.text);\n  }\n  if (`statusText` in copiedAction.payload && copiedAction.payload.statusText) {\n    copiedAction.payload.statusText = stripAnsi(\n      copiedAction.payload.statusText,\n    );\n  }\n\n  return copiedAction;\n};\n\nexport function initializeJSONLogger(): void {\n  onLogAction((action: ActionsUnion) => {\n    const sanitizedAction = sanitizeAction(action);\n\n    process.stdout.write(JSON.stringify(sanitizedAction) + `\\n`);\n  });\n}\n"],"mappings":";;;;;AAAA,IAAAA,MAAA,GAAAC,OAAA;AAEA,IAAAC,UAAA,GAAAC,sBAAA,CAAAF,OAAA;AACA,IAAAG,OAAA,GAAAD,sBAAA,CAAAF,OAAA;AAEA,MAAMI,eAAe,GAAIC,MAAoB,IAC3C,OAAOA,MAAM,CAACC,OAAO,KAAM,QAAO;AAEpC,MAAMC,cAAc,GAAIF,MAAoB,IAAmB;EAC7D,MAAMG,YAAY,GAAG,IAAAC,eAAS,EAACJ,MAAM,CAAC;EAEtC,IAAID,eAAe,CAACI,YAAY,CAAC,EAAE;IACjC,OAAOA,YAAY;EACrB;EAEA,IAAK,MAAK,IAAIA,YAAY,CAACF,OAAO,IAAIE,YAAY,CAACF,OAAO,CAACI,IAAI,EAAE;IAC/DF,YAAY,CAACF,OAAO,CAACI,IAAI,GAAG,IAAAC,kBAAS,EAACH,YAAY,CAACF,OAAO,CAACI,IAAI,CAAC;EAClE;EACA,IAAK,YAAW,IAAIF,YAAY,CAACF,OAAO,IAAIE,YAAY,CAACF,OAAO,CAACM,UAAU,EAAE;IAC3EJ,YAAY,CAACF,OAAO,CAACM,UAAU,GAAG,IAAAD,kBAAS,EACzCH,YAAY,CAACF,OAAO,CAACM,UACvB,CAAC;EACH;EAEA,OAAOJ,YAAY;AACrB,CAAC;AAEM,SAASK,oBAAoBA,CAAA,EAAS;EAC3C,IAAAC,kBAAW,EAAET,MAAoB,IAAK;IACpC,MAAMU,eAAe,GAAGR,cAAc,CAACF,MAAM,CAAC;IAE9CW,OAAO,CAACC,MAAM,CAACC,KAAK,CAACC,IAAI,CAACC,SAAS,CAACL,eAAe,CAAC,GAAI,IAAG,CAAC;EAC9D,CAAC,CAAC;AACJ"}